row:
    map:
        columns: 
            - patient_id
        to_subject: patient
transformers:
    - map:
        columns:
            - sample_id
        to_object: sample
        via_relation: patient_carries_sample
    - cat_format:
        columns:
            - hugoSymbol
            - alteration
        from_subject: sample
        to_object: alteration
        format_string: "{hugoSymbol}:{alteration}"
        via_relation: sample_carries_alteration
    - map:
        columns:
            - hugoSymbol
        from_subject: alteration
        to_object: gene
        via_relation: alteration_affects_gene
    - cat_format:
        columns:
          - hugoSymbol
          - gene_role
        from_subject: alteration
        to_object: functional_outcome
        format_string: "{hugoSymbol}:{gene_role}"
        via_relation: alteration_causes_functional_outcome
    - map:
        columns:
            - hugoSymbol
        from_subject: functional_outcome
        to_object: gene
        via_relation: functional_outcome_affects_gene
    - map:
        columns:
            - referenceGenome
        to_property:
            - reference_genome
        for_objects:
            - alteration
    - map:
        columns:
            - tumorType
        to_property:
            - tumor_type
        for_objects:
            - alteration
    - map:
        columns:
            - oncogenic
        to_property:
            - oncogenic
        for_objects:
            - alteration
    - map:
        columns:
            - mutationEffectDescription
        to_property:
            - mutation_effect_description
        for_objects:
            - alteration
    - map:
        columns:
            - variantSummary
        to_property:
            - variant_summary
        for_objects:
            - alteration
    - map:
        columns:
            - tumorTypeSummary
        to_property:
            - tumor_type_summary
        for_objects:
            - alteration
    - map:
        columns:
            - citationPMids
        to_property:
            - citation_PM_ids
        for_objects:
            - alteration
    - map:
        columns:
            - level_of_evidence
        to_property:
            - level_of_evidence
        for_objects:
            - alteration
metadata:
        - name: copy_number_alterations


validate: # Validation for cna labeled "local.".
  columns:
    patient_id:
      dtype: str
      description: "Cohort code from clinical data"
    sample_id:
      dtype: str
      description: "Sample id of biopsy (origin OVCA database)"
    referenceGenome:
      dtype: str
      description: "Standard human reference genome used in WGS read alignment"
      checks:
        isin:
          - GRCh37
          - GRCh38
    hugoSymbol:
      dtype: str
      description: "Gene name in Hugo nomenclature"
    alteration:
      dtype: str
      description: "Genomic alteration type"
      checks:
        isin:
          value:
            - AMPLIFICATION
            - DELETION
            - UNKNOWN
    tumorType:
      dtype: str
      description: "Tumor type abbreviation (OncoTree based)"
      checks:
        isin:
          value:
            - HGSOC
    ploidy:
      dtype: float64
      description: "The number of complete sets of chromosomes in cancer cells"
    nMinor:
      dtype: int64
      description: "Minor allele copynumber"
    nMajor:
      dtype: int64
      description: "Major allele copynumber"
    lohstatus:
      dtype: str
      description: "Loss of heterozygosity status"
      checks:
        isin:
          value:
            - HET
            - LOH
    chromosome:
      dtype: str
      description: "Chromosome number where alteration is occurring"
    start:
      dtype: int64
      description: "Start position of alteration in chromosome"
    end:
      dtype: int64
      description: "End position of alteration in chromosome"
    strand:
      dtype: int64
      description: "DNA strand"
      checks:
        isin:
          value:
            - -1
            - 1
    band:
      dtype: str
      description: "Chromosomal locus"
    nProbesCr:
      dtype: int64
      description: "Number of probes"
    nProbesAf:
      dtype: int64
      description: "Number of probes"
    logR:
      dtype: float64
      description: "Signal intensity"
    baf:
      dtype: float64
      description: "B-allele frequency of occurrence"
    nAraw:
      dtype: float64
      description: "Calculated copy number of allele A"
    nBraw:
      dtype: float64
      description: "Calculated copy number of allele B"
    purifiedLogR:
      dtype: float64
      description: "Mean signal intensity"
    purifiedBaf:
      dtype: float64
      description: "B-allele frequency measurement"
    purifiedLoh:
      dtype: float64
      description: "LoH measurement"
    minPurifiedLogR:
      dtype: float64
      description: "Minimum measured signal intensity"
    maxPurifiedLogR:
      dtype: float64
      description: "Maximum measured signal intensity"
    breaksInGene:
      dtype: int64
      description: "Number of copy number level shift points in alteration"